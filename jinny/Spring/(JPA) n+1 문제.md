## N+1 문제
연관 관계가 설정된 엔티티를 조회할 경우에 조회된 데이터 갯수(n) 만큼 연관관계의 조회 쿼리가 추가로 발생하여 데이터를 읽어오는 현상

지연 로딩에서는 N+1 문제가 발생하지 않는 것처럼 보이지만
막상 객체를 탐색하려고 하면 N+1 문제가 발생되어 N+1문제가 발생되는 시점만 즉시 로딩과 다를 뿐

## 발생 이유
영속성 컨텍스트에서 연관된 테이블 있는지 확인
영속성 컨텍스트에 없다면 테이블의 인스턴스들 개수에 맞게 select * from ~ 이라는 SQL 구문이 생성( N+1 발생 )


## 해결 방법
1. Fetch Join
JPQL을 사용하여 DB에서 데이터를 가져올 때 처음부터 연관된 데이터까지 같이 가져오게 하는 방법
조회의 주체가 되는 Entity 이외에 Fetch join이 걸린 연관 Entity도 같이 영속성 컨텍스트에서 관리
JPA가 제공하는 Pageable 기능 사용 불가(Pageable 사용 불가) → 페이징 단위로 데이터 가져오기 불가능
3. EntityGraph 어노테이션
@EntityGraph 라는 어노테이션을 사용해서 fetch 조인을 하는 것 비추...
outerJoin을 사용하기 때문에 중복 데이터 발생함 (카테시안 곱 현상)
→ Set으로 중복 방지/distinct 적용
4. Batch Size
이 옵션은 정확히는 N+1 문제를 안 일어나게 하는 방법은 아니고 
N+1 문제가 발생하더라도 select * from user where id = ? 이 아닌 select * from user where id in (?, ?, ? ) 방식으로 N+1 문제가 발생하게 하는 방법
100번 일어날 N+1 문제를 1번만 더 조회하는 방식으로 성능을 최적화



