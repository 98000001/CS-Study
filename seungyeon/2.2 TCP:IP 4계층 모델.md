# 2.2

### 계층  구조

- TCP/IP 4계층
    
    
    | 애플리케이션 계층 | FTP/HTTP/SSH/SMTP/DNS |
    | --- | --- |
    | 전송 계층 | TCP/UDP/QUIC |
    | 인터넷 계층 | IP/ARP/ICMP |
    | 링크 계층 | 이더넷 |
- 애플리케이션 계층
    - 웹서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층
    - FTP : 장치간의 파일 전송하는데 사용되는 표준 통신 프로토콜
    - SSH : 보안되지 않는 네트워크에서 네트워크 서비스를 안전하게 운영하기 위한 암호화 네트워크 프로토콜
    - HTTP : WWW를 위한 데이터 통신의 기초이자 웹 사이트를 이용하는데 쓰는 프로토콜
    - SMTP : 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜
    - DNS : 도메인 이름과 IP 주소를 매핑해주는 서버
- 전송 계층
    - 송수신자를 연결하는 통신 서비스 제공
    - 연결 지향 데이터 스트림 지원, 신뢰성, 흐름제어 제공 가능
    - 애플리케이션과 인터넷 계층 사이의 데이터가 전달될 때 중계 역할
    - TCP : 패킷 사이의 순서 보장. 연결지향 프로토콜 사용. 가상회선 패킷 교환 방식 사용
        - 가상회선 패킷 교환 방식
            - 각 패킷에는 가상회선 식별자가 포함됨. 모든 패킷을 전송하면 가상 회선이 해제됨. 패킷들은 전송된 순서대로 도착
        - 3-way handshake
            - SYN : [클라이언트 → 서버] 클라이언트의 ISN을 담아 SYN을 보냄.
                - SYN : 연결 요청 플래그
                - ISN : 새로운 TCP 연결의 첫번째 패킷에 할당된 임의의 시퀀스 번호
            - SYN + ACK : [서버 → 클라이언트] 서버는 클라이언트의 SYN을 수신하고 서버의 ISN을 보내며 승인번호로 클라이언트 ISN + 1 을 보냄
            - ACK : [클라이언트 → 서버] ISN + 1 인 ACK 보냄
                - ACK : 응답 플래그
        - 4-way handshake
            - 클라이언트가 연결을 닫으려고 할 때 FIN으로 설정된 세그먼트 보냄 클라이언트는 FIN_WAIT_1 상태가 되고 서버의 응답을 기다림
            - 서버는 클라이언트로 ACK 승인 세그먼트를 보냄 CLOSE_WAIT 상태가 됨. 클라이언트는 FIN_WAIT_2 상태가 됨
            - 서버는 ACK를 보내고 일정시간 이후에 FIN을 보냄
            - 클라이언트는 TIME_WAIT이 되고 다시 서버로 ACK 보냄. 서버는 CLOSED 상태가 됨. 모든 자원 해제됨
    - UDP : 패킷 사이 순서 보장하지 않음. 수신 확인하지 않음. 데이터그램 패킷 교환 방식 사용
        - 데이터그램 패킷 교환 방식
            - 패킷이 독립적으로 이동하며 최적의 경로를 선택해 이동. 하나의 메시지에서 분할된 패킷은 서로 다른 경로로 전송 가능. 도착한 순서가 다를 수 있음.
- 인터넷 계층
    - 장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용됨
    - IP,ARP,ICMP 등이 있으며 패킷을 수신할 상대 주소를 지정해 데이터 전달
    - 상대방이 제대로 받았는지에 대해 보장하지 않음
- 링크 계층
    - 전선,광섬유, 무선 등으로 실질적으로 데이터를 전달하며 장치간에 신호를 주고받는 규칙을 정함
    - 물리계층 : 유/무선 LAN 을 통해 0과1로 이루어진 데이터를 보내는 계층
    - 데이터링크 계층 : 이더넷 프레임을 통해 에러확인,흐름제어, 접근 제어를 담당함
    - 유선 LAN(IEEE802.3)
        - IEEE802.3을 따름
        - 전이중화 통신 (full duplex)
            - 양쪽 장치가 동시에 송수신 할 수 있는 방식
            - 송신로/수신로로 나누어 데이터를 주고받으며 현대 고속 이더넷의 기반
        - CSMA/CD
            - 반이중화 통신 중 하나임
            - 데이터를 보낸 이후 충돌이 발생한다면 일정 시간 이후 재전송
            - 송/수신로를 나누지 않고 경로 기반으로 데이터를 보내기때문에 데이터 충돌에 대한 대비가 필요했음
    - 유선 LAN 케이블
        - 트위스트 페어 케이블
            - 하나의 케이블로 보이지만 실제로 8개의 구리선을 두개씩 꼬아서 묶은 케이블
        - 광섬유 케이블
            - 레이저를 이용해 통신
            - 구리선과 비교할 수 없을 만큼 장거리 및 고속 통신 가능
    - 무선 LAN(IEEE802.11)
        - 송/수신에 같은 채널을 사용하기에 반이중화 통신을 사용
        - 장치가 신호를 수신하기 시작하면 응답 전에 전송이 완료될 때까지 기다려야함
        - 둘 이상의 장치가 동시에 전송하며 충돌이 발생해 메시지가 손실.외곡 될 수 있기에 충돌 방지 시스템 필요
        - CSMA/CA
            - 데이터 전송 전에 일련의 과정을 기반으로 사전에 가능한 충돌을 방지
            - 사용중인채널이 있다면 다른 채널을 감지하다 유후 상태인 채널 발견 → 프레임간 공간 시간인 IFS 만큼 기다림. → ACK 를 주고받으며 충돌 방지 ..
    - 무선 LAN 주파수
        - 2.4GHz 는 장애물에 강한 특성을 가지지만 전자레인지, 무선 등 전파 간섭이 일어나는 경우가 많음
        - 5GHz 는 사용할 수 있는 채널 수도 많고 동시에 사용할 수 있기에 상대적으로 깨끗한 전파 환경 구축 가능
        - 와이파이
            - 전자 기기들이 무선 LAN 신호에 연결 할 수 있게하는 장치, 무선 접속 장치(공유기)가 필요함
            - 공유기를 통해 유선 LAN 에 흐르는 신호를 무선 LAN 신호로 바꿔주어 신호가 닿는 범위에서 무선 인터넷 사용 가능
        - BSS(Basic Service Set)
            - 기본 서비스 집합
            - 단순 공유기를 통해 네트워크에 접속하는 것이 아닌, 동일 BSS 내에 있는 AP 들과 서로 통신이 가능한 구조.
            - 근거리 무선 통신을 제공하고 하나의 AP 만들 기반으로 구축되어 있어ㅓ ..
        - ESS(Extended Service Set)
            - 하나 이상의 연결된 BSS 그룹
            - 장거리 무선 통신을 제공. BSS 보다 더 많은 가용성과 이동성 지원
            - 사용자는 한 장소에서 다른 장소로 이동하며 네트워크에 계속 연결 가능
        - 이더넷프레임
            
            
            | Preamble | SFD | DMAC | SAMC | EtherType | Payload | CRC |
            | --- | --- | --- | --- | --- | --- | --- |
            | 이더넷 프레임의 시작 | MAC 주소 필드 시작을 알림 | 수신 MAC 주소 | 송신 MAC 주소 | IP 프로토콜 정의 | 전달받은 데이터 | 에러확인 비트 |
    - 캡슐화/비캡슐화 과정
        
        
        | 애플리케이션 계층 |
        | --- |
        | TCP(L4) 헤더 |
        | 전송 계층 |
        | IP(L3) 헤더 |
        | 인터넷 계층 |
        | 프레임 헤더 |
        | 링크 계층 |
        | 프레임 트레일러 |
    - PDU
        - 네트워크의 어떠한 계층에서 다른 계층으로 데이터가 전달될 때 한 덩어리 단위를 PDU