## HTTP

### HTTP/1.0

- 기본적으로 1연결 1요청 → RTT 증가
    - RTT : 패킷이 목적지에 도달하고 나서 다시 출발지까지 돌아오기까지 걸리는 시간.
    - `단점` 요청마다 TCP 3-way handShake 를 열어야하기에 RTT 증가
- RTT 증가를 해결하기 위한 방법
    - 이미지 스플리팅, 코드 압축, 이미지 Base64 인코딩

### HTTP/1.1

- 매번 TCP 연결을 하는 것이 아니라, 한번 TCP 초기화를 한 이후에 keep-alive 옵션으로 여러 파일을 송수신 할 수 있음
    - HTTP/1.1 부터 표준화되어 기본 옵션으로 설정됨
    - `단점` 문서 안에 포함된 다수의 리소스를 처리하려면 요청할 리소스 개수에 비례해 대기 시간이 길어짐
    - `단점` HOL Blocking (Head Of Line)
        - 네트워크에서 같은 큐에 있는 패킷이 그 **첫번째 패킷에 의해 지연될 때** 발생하는 성능 저하 현상
    - `단점`  무거운 헤더 구조
        - HTTP/1.1 의 헤더에는 많은 메타데이터가 들어있고 압축이 되지 않아 무거움
    

### HTTP/2

- HTTP/1.x 보다 지연 시간을 줄이고 응답시간을 빠르게 하며, 멀티플렉싱, 헤더 압축, 서버 푸시, 요청 우선순위 처리 등을 지원함
- 멀티플렉싱
    - 여러개의 스트림을 사용해 송수신 → 특정 스트림의 패킷이 손실 되어도 해당 스트림만 영향 미침
    - 단일 연결 + 병렬로 여러 요청/응답 가능 → HTTP/1.x의 HOL Blocking 해결
- 헤더 압축
    - HTTP/1.x 는 무거운 헤더 구조가 단점이었음.
    - 허프만 코딩 압축 알고리즘 사용 ( HPACK 압축 형식)
        - 문자열을 문자 단위로 쪼개. 빈도수를 세어 빈도가 높으면 적은 비트수, 빈도가 낮으면 많은 비트수
            
            → 전체 데이터 표현에 필요한 비트양 줄임
            
- 서버 푸시
    - HTTP/1.x 는 클라이언트 → 서버 요청해야 파일 다운 가능.
    - HTTP/2 는 클라이언트 요청 없이 서버가 바로 리소스 푸시 가능

### HTTPS

- 애플리케이션 계층과 전송 계층 사이 신뢰 게층인 SSL/TLS 계층을 넣은 HTTP 요청
    
    → 통신을 암호화
    
- SSL/TLS
    - 전송 계층에서 보안을 제공하는 프로토콜
    - 클라이언트-서버 간의 통신에서 제 3자가 메시지 도청/변조(스푸핑?) 하지 못하게 함
    - 공격자가 서버인 척하면 사용자 정보 가로채는 인터셉터 방지 가능
    - **보안 세션** 기반 데이터를 암호화하며 보안 세션이 만들어질 때 **인증 메커니즘**, 키 교환 암호화 알고리즘, 해싱 알고리즘이 사용됨
    - 보안 세션
        - 보안이 시작되고 끝나는 동안 유지되는 세션
        - SSL/TLS 는 핸드쉐이크를 통해 보안 세션을 생성하고 이를 기반으로 정보 공유
        - 키 공유, 이를 기반으로 인증, 인증 확인이 일어나는 1번의 RTT 이후 데이터 송수신
            - 사이퍼 슈트
            - AEAD 사이퍼 모드 ..
    - 인증 메커니즘
        - CA에서 발급한 인증서를 기반으로 이루어짐.
        - 안전한 연결을 시작하는데 있어 공개키를 클라이언트에 제공하여 서버가 신뢰할 수 있는 서버임을 보장
        - CA 인증서를 발급받으려면 사이트 정보, 공개키를 CA에 제출해야함
    - 키 교환 암호화 알고리즘
        - ECDHE/DHE 사용
        - 디비-헬만 방식을 근간으로 만들어짐
        - 디피-헬만 키 교환 암호화 알고리즘
            - 공개값 공유 → 각자의 비밀값과 혼합 → 혼합 값 공유 → 각자의 비밀 값과 혼합 → 공통의 암호키 생성(PSK)
    - 해싱 알고리즘
        - SHA-256
            - 해시 함수 결괏값이 256비트
- SEO 에 도움되는 HTTPS
    - 구글은 SSL 인증을 강조함. HTTPS 서비스를 하는 사이트가 SEO 순위가 높을 것임을 공식적으로 밝힘
        - SEO : 검색 엔진 최적화, 검색 엔진으로 웹 사이트 검색할 때 상위에 노출시킴
- HTTPS 구축 방법
    - CA 인증키 기반으로 HTTPS 서비스 구축
    - 서버 앞단에 HTTPS 제공하는 로드밸런서 배치
    - 서버 앞단에 HTTPS 제공하는 CDN 배치

### HTTP/3

- QUIC 이라는 계층 위에서 UDP 기반으로 돌아감
    - HTTP/2 는 TCP 위에서 돌아감
    - 초기 연결 설정 시 지연 시간 감소
        - TCP 를 사용하지 않기에 3-way-handshake 사용하지 않아도 됨
        - 첫 연결 설정에 1-RTT 소요
        - 순방향 오류 수정 메커니즘(FEC) 가 적용되어 전송한 패킷이 손실되었다면 수신 측에서 에러를 검출하고 수정하는 방식
        - 열악한 네트워크 환경에서 낮은 패킷 손실률